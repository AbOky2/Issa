{"ast":null,"code":"import _regeneratorRuntime from \"/usr/src/kit-le-nid/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/usr/src/kit-le-nid/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/usr/src/kit-le-nid/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/* eslint-disable jsx-a11y/no-static-element-interactions */\n\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { Grid, Card, CardActionArea, CardActions, CardContent, CardMedia, Typography } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { AdminContentWrapper } from '../../components/wrapper';\nimport { Modal, Icon } from '../../components/form'; // import { ReactComponent as LotsIcon } from 'assets/img/svg/partners.svg';\n// import { ReactComponent as AddIcon } from 'assets/img/svg/add.svg';\n\nimport { getPartnersApiMethod, deletePartnerApiMethod } from '../../lib/api/admin';\nimport withAuth from '../../lib/withAuth';\nimport { partnerTypeListKeys, partnerTypes } from '../../helpers/partner';\nimport PartnerModal from '../../components/admin/partnerModal';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    media: {\n      height: 140\n    },\n    closeModal: {\n      position: 'absolute',\n      top: 10,\n      right: 10,\n      cursor: 'pointer',\n      padding: 10,\n      zIndex: 10,\n      '&:hover': {\n        backgroundColor: '#bbd0ff',\n        color: 'white'\n      }\n    }\n  };\n});\n\nfunction ListCard(_ref) {\n  var data = _ref.data;\n  var classes = useStyles();\n  return __jsx(Card, {\n    className: classes.root\n  }, __jsx(CardActionArea, null, __jsx(CardMedia, {\n    className: classes.media,\n    image: data === null || data === void 0 ? void 0 : data.picture,\n    title: \"Contemplative Reptile\"\n  }), __jsx(CardContent, null, __jsx(Typography, {\n    gutterBottom: true,\n    variant: \"h5\",\n    component: \"h2\"\n  }, data.name), __jsx(Typography, {\n    variant: \"body2\",\n    color: \"textSecondary\",\n    component: \"p\"\n  }, data.description))), __jsx(CardActions, null, __jsx(\"div\", {\n    className: \"auto\"\n  }, partnerTypes[data.type])));\n}\n\nvar defaultAddNew = {\n  _id: null,\n  picture: null,\n  name: 'aaaa-',\n  description: 'bbbb',\n  link: 'cccc',\n  position: 5\n};\n\nvar Header = function Header(_ref2) {\n  var onClick = _ref2.onClick;\n  return __jsx(Grid, {\n    container: true,\n    justify: \"space-between\",\n    alignItems: \"center\"\n  }, __jsx(Grid, {\n    item: true\n  }, __jsx(Grid, null, __jsx(\"span\", {\n    className: \"header-icon\"\n  }, __jsx(Icon, {\n    type: \"sponsorship\",\n    size: \"small\"\n  })), __jsx(\"h1\", null, \"Offres partenaires\"))), __jsx(Grid, {\n    item: true\n  }, __jsx(Grid, {\n    onClick: onClick,\n    className: \"submit pointer partner-add\"\n  }, __jsx(\"span\", {\n    className: \"header-icon\"\n  }, __jsx(Icon, {\n    type: \"plus\",\n    size: \"small\"\n  })), __jsx(\"p\", null, \"Ajouter\"))));\n};\n\nvar noFilter = null;\n\nvar PartnersDashboard = function PartnersDashboard() {\n  var _useState = useState(noFilter),\n      filter = _useState[0],\n      setFilter = _useState[1];\n\n  var _useState2 = useState([]),\n      partners = _useState2[0],\n      setPartners = _useState2[1];\n\n  var _useState3 = useState({\n    openModal: false,\n    editElement: {}\n  }),\n      state = _useState3[0],\n      setState = _useState3[1];\n\n  var handleChange = useCallback(function (name, value) {\n    return setState(_objectSpread(_objectSpread({}, state), {}, _defineProperty({}, name, value)));\n  }, [state, setState]);\n\n  var toggleState = function toggleState(name) {\n    return handleChange(name, !state[name]);\n  };\n\n  var resetState = useCallback(function () {\n    return setState(_objectSpread(_objectSpread(_objectSpread({}, state), {}, {\n      openModal: false,\n      filter: noFilter\n    }, defaultAddNew), {}, {\n      editElement: {}\n    }));\n  }, [state, setState]);\n\n  var handleClose = function handleClose() {\n    return resetState();\n  };\n\n  var handleActiveFilter = useCallback(function (name) {\n    return setFilter(name);\n  }, [setFilter]);\n\n  var onClick = function onClick() {\n    return toggleState('openModal');\n  };\n\n  var reloadPartners = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var _yield$getPartnersApi, list;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return getPartnersApiMethod();\n\n          case 2:\n            _yield$getPartnersApi = _context.sent;\n            list = _yield$getPartnersApi.list;\n            setPartners(list);\n            resetState();\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), [resetState, setPartners]);\n\n  var handleEditSelect = function handleEditSelect(id) {\n    setState({\n      openModal: true,\n      editElement: partners.find(function (e) {\n        return e._id === id;\n      })\n    });\n  };\n\n  var handleDelete = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return deletePartnerApiMethod(id);\n\n            case 2:\n              reloadPartners();\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleDelete(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    reloadPartners();\n  }, []);\n  var filteredList = filter ? partners.filter(function (elem) {\n    return elem.type === filter;\n  }) : partners;\n  var classes = useStyles();\n  return __jsx(React.Fragment, null, __jsx(AdminContentWrapper, null, __jsx(Modal, {\n    openModal: state.openModal,\n    onClose: handleClose,\n    onClick: onClick,\n    showActions: false\n  }, __jsx(Grid, {\n    container: true,\n    item: true,\n    xs: 12,\n    justify: \"flex-start\"\n  }, __jsx(PartnerModal, {\n    current: state.editElement,\n    handleSubmit: reloadPartners,\n    handleClose: handleClose\n  }))), __jsx(Grid, {\n    container: true,\n    direction: \"row\",\n    justify: \"space-between\",\n    alignItems: \"center\",\n    className: \"spacing header\"\n  }, __jsx(Grid, {\n    item: true,\n    container: true,\n    xs: 12,\n    justify: \"flex-start\"\n  }, __jsx(Grid, {\n    item: true,\n    container: true,\n    alignItems: \"center\"\n  }, __jsx(Header, {\n    onClick: onClick\n  })))), __jsx(Grid, {\n    container: true\n  }, __jsx(Grid, {\n    container: true,\n    justify: \"center\"\n  }, __jsx(\"div\", {\n    onClick: function onClick() {\n      return handleActiveFilter(noFilter);\n    },\n    className: \"partner-filter\"\n  }, \"Tout\"), partnerTypeListKeys.map(function (elem) {\n    return (// eslint-disable-next-line jsx-a11y/no-static-element-interactions\n      __jsx(\"div\", {\n        key: elem,\n        onClick: function onClick() {\n          return handleActiveFilter(elem);\n        },\n        className: \"partner-filter \".concat(elem === filter ? 'active' : '')\n      }, partnerTypes[elem])\n    );\n  })), __jsx(Grid, {\n    container: true,\n    className: \"partner-card-list-container\",\n    justify: \"space-arround\"\n  }, filteredList.map(function (elem) {\n    return __jsx(Grid, {\n      item: true,\n      key: elem._id,\n      alignItems: \"center\",\n      md: 4,\n      onClick: function onClick() {\n        return handleEditSelect(elem._id);\n      },\n      className: \"partner-card-list relative\"\n    }, __jsx(\"span\", {\n      onClick: function onClick(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        handleDelete(elem._id);\n      },\n      className: classes.closeModal\n    }, \"x\"), __jsx(ListCard, {\n      data: elem\n    }));\n  })))));\n};\n\nexport default withAuth(PartnersDashboard, {\n  adminRequired: true\n});","map":null,"metadata":{},"sourceType":"module"}